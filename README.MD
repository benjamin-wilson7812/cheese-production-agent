# ğŸ§€ Cheese Product Reasoning Chatbot

An interactive AI-powered chatbot that assists with complex queries about a cheese production database. Built with **LangChain-style reasoning**, **SQL tools**, **Vector DB search**, and a clean **Streamlit UI** supporting chat history, reasoning visualization, and clarifying questions.

---

## ğŸš€ Features

- ğŸ” Intelligent product search using SQL and vector similarity tools.
- ğŸ§  Step-by-step reasoning with state tracking (`sql_query`, `vectordb_query`, `both`, `complete`, `self`).
- ğŸ’¬ Conversational memory and chat history sidebar.
- ğŸ§¾ Clarification prompts when user queries are ambiguous.
- ğŸŒ Uses GPT-4o (or any OpenAI-compatible LLM) for reasoning and tool selection.
- ğŸ§Š Pinecone as vector DB, MySQL for structured data.

---

## ğŸ—ï¸ Architecture
```sql
User â†’ Streamlit UI â†’ LangChain-style Reasoning Engine â†’ Tools:
                                                          â”œâ”€â”€ SQLQueryTool â†’ MySQL DB
                                                          â”œâ”€â”€ VectorDBTool â†’ Pinecone
                                                          â””â”€â”€ ClarificationTool â†’ User
```

---

## ğŸ§© Components

### Backend
- **LangChain-style Reasoning Agent**: Determines when to use SQL, vectordb, or ask the user.
- **Tools**:
  - `sql_query`: Executes SQL against MySQL cheese product database.
  - `vectordb_query`: Uses Pinecone to search semantically.
  - `clarification`: Requests more info from user if query is vague.

### Frontend (Streamlit)
- **Chat interface**: Display user & agent messages with markdown and role distinction.
- **Sidebar**: Chat history list (like ChatGPT).
- **Reasoning trace**: Each step (tool usage, thoughts, final answer) is shown interactively.

---

## ğŸ—ƒï¸ Database Schema

MySQL table: `cheese_product`
- sku VARCHAR(20) PRIMARY KEY,
- name TEXT,
- brand VARCHAR(100),
- department VARCHAR(100),
- each_item_counts VARCHAR(50),
- each_dimensions VARCHAR(100),
- each_weights VARCHAR(50),
- case_item_counts VARCHAR(50),
- case_dimensions VARCHAR(100),
- case_weights VARCHAR(50),
- images JSON,
- relateds JSON,
- each_prices DECIMAL(10,2),
- case_prices DECIMAL(10,2),
- price_per VARCHAR(20),
- discount VARCHAR(100),
- empty BOOLEAN,
- href TEXT,
- price_order INT,
- popularity_order INT
---

## ğŸ’» Installation

```bash
# Clone the repo
git clone https://github.com/benjamin-wilson7812/cheese-production-agent.git
cd cheese-production-agent

# Install dependencies
pip install -r requirements.txt
```
##### Set up your .env with the following keys:
```env
OPENAI_API_KEY=
PINECONE_API_KEY=
PINECONE_INDEX_NAME=
LANGCHAIN_API_KEY=
DB_NAME="cheese"
DB_HOST=
DB_PASSWORD=
DB_USER=
DB_PORT=
```
## â–¶ï¸ Running the App
```bash
streamlit run main.py
```
The app will launch in your browser at http://localhost:8501.
## ğŸ“‚ Project Structure
```pgsql
â”œâ”€â”€ app/
â”‚ â”œâ”€â”€ core/
â”‚ â”‚ â”œâ”€â”€ prompt_templates/
â”‚ â”‚ â”‚ â””â”€â”€ generate_reasoning_step.py
â”‚ â”‚ â””â”€â”€ config.py
â”‚ â”œâ”€â”€ db/
â”‚ â”‚ â”œâ”€â”€ mysql.py
â”‚ â”‚ â””â”€â”€ vectordb.py
â”‚ â”œâ”€â”€ schemas/
â”‚ â”‚ â”œâ”€â”€ cheese_products.py
â”‚ â”‚ â””â”€â”€ sentence_embedded.py
â”‚ â””â”€â”€ services/
â”‚  â”œâ”€â”€ chat.py
â”‚  â””â”€â”€ graph/
â”‚     â”œâ”€â”€ graph_nodes.py
â”‚     â””â”€â”€ graph_state.py
â”œâ”€â”€ scripts/
â”‚ â””â”€â”€ data_preprocess.py
â”œâ”€â”€ main.py
â”œâ”€â”€ graph.png
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â””â”€â”€ .env
```
## ğŸ“œ License
MIT License